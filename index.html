<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Words Separator App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase App and Firestore SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 900px;
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .municipality {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .description {
            font-size: 1rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .app-content {
            padding: 25px;
        }
        
        .input-section {
            margin-bottom: 25px;
        }
        
        textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            resize: none;
            font-size: 16px;
        }
        
        textarea:focus {
            outline: none;
            border-color: #6a11cb;
        }
        
        .buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .save-btn {
            background: linear-gradient(to right, #2ecc71, #27ae60);
        }
        
        .firebase-btn {
            background: linear-gradient(to right, #FFA000, #FF8F00);
        }
        
        .total-btn {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
        }
        
        .output-section {
            margin-top: 20px;
        }
        
        .output-title {
            font-size: 1.3rem;
            color: #444;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .words-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .word-box {
            width: 140px;
            padding: 12px;
            border-radius: 8px;
            background-color: #f8f9fa;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.2s ease;
        }
        
        .word-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .word {
            font-weight: bold;
            color: #2575fc;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .pos {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
        }
        
        .translation-input {
            width: 100%;
            padding: 8px;
            border: 1px dashed #adb5bd;
            border-radius: 4px;
            font-size: 14px;
            text-align: center;
            transition: border-color 0.3s ease;
        }
        
        .translation-input:focus {
            outline: none;
            border-color: #6a11cb;
            border-style: solid;
        }
        
        .instructions {
            background-color: #e8f4fc;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        footer {
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
            color: #6c757d;
        }
        
        .footer-text {
            margin: 5px 0;
        }
        
        .save-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
            text-align: center;
        }
        
        .save-options {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: #2ecc71;
            color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            animation: fadeIn 0.3s, fadeOut 0.3s 2.7s forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-20px); }
        }
        
        .notification.error {
            background: #e74c3c;
        }
        
        .notification.show {
            display: block;
        }
        
        .language-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            align-items: center;
        }
        
        select {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        .total-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: #6a11cb;
            margin: 10px 0;
        }
        
        .unique-words {
            margin-top: 15px;
            padding: 10px;
            background-color: white;
            border-radius: 8px;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .unique-word {
            display: inline-block;
            background: #e8f4fc;
            padding: 5px 10px;
            margin: 4px;
            border-radius: 20px;
        }

        /* Firebase buttons */
        .firebase-options {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        /* Modal for displaying saved translations */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            width: 500px;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6c757d;
        }
        
        .translation-item {
            border-bottom: 1px solid #eee;
            padding: 10px 0;
            margin-bottom: 10px;
        }
        
        .load-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .load-btn:hover {
            background: #2980b9;
        }
        
        .copyright {
            font-weight: bold;
            color: #6a11cb;
        }
        
        .firebase-config {
            margin-top: 20px;
            padding: 15px;
            background: #fff8e1;
            border-radius: 8px;
            border-left: 4px solid #FFA000;
        }
        
        .firebase-config h4 {
            margin-bottom: 10px;
            color: #FFA000;
        }
        
        .config-input {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .progress-bar {
            height: 5px;
            width: 100%;
            background: #f0f0f0;
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .btn-loading {
            position: relative;
            color: transparent;
        }
        
        .btn-loading::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            margin-left: -10px;
            margin-top: -10px;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .word-box {
                width: 120px;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .word-box {
                width: 100%;
            }
            
            header {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Words Separator App</h1>
            <div class="municipality">Omar Municipality, Sulu, Philippines</div>
            <div class="description">Separate sentences into words with parts of speech and translations</div>
        </header>
        
        <div class="app-content">
            <div class="firebase-config">
                <h4><i class="fas fa-database"></i> Firebase Configuration</h4>
                <p>Enter your Firebase configuration to enable cloud saving:</p>
                <input type="text" id="firebaseApiKey" class="config-input" placeholder="API Key">
                <input type="text" id="firebaseProjectId" class="config-input" placeholder="Project ID">
                <button id="initFirebaseBtn" class="firebase-btn">
                    <i class="fas fa-plug"></i> Initialize Firebase
                </button>
                <div class="progress-bar">
                    <div class="progress" id="firebaseProgress"></div>
                </div>
            </div>
            
            <div class="input-section">
                <textarea id="inputText" placeholder="Enter a sentence to analyze...">The quick brown fox jumps over the lazy dog</textarea>
                <div class="language-selector">
                    <span>Translate to:</span>
                    <select id="languageSelect">
                        <option value="en">English</option>
                        <option value="ts">Tausug</option>
                        <option value="ar">Arabic</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="it">Italian</option>
                        <option value="pt">Portuguese</option>
                        <option value="custom">Custom (Write your own)</option>
                    </select>
                </div>
                <div class="buttons">
                    <button id="processBtn">
                        <i class="fas fa-cogs"></i> Process Sentence
                    </button>
                    <button id="resetBtn">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                    <button id="totalBtn" class="total-btn">
                        <i class="fas fa-calculator"></i> Total
                    </button>
                </div>
            </div>
            
            <div class="instructions">
                <p><strong>How to use:</strong> Enter a sentence and click "Process Sentence". The app will separate words and identify parts of speech. You can write your translations in the input boxes below each word. All translation fields are fully editable.</p>
            </div>
            
            <div class="output-section">
                <h2 class="output-title">Word Analysis</h2>
                <div id="wordsContainer" class="words-container">
                    <!-- Words will be generated here -->
                </div>
            </div>
            
            <div class="total-section">
                <h3>Word Count</h3>
                <div id="totalDisplay" class="total-display">Total Unique Words: 0</div>
                <div id="uniqueWords" class="unique-words">
                    <!-- Unique words will be displayed here -->
                </div>
            </div>
            
            <div class="save-section">
                <h3>Save Your Translations</h3>
                <p>Click to save:</p>
                <div class="save-options">
                    <button id="saveJsonBtn" class="save-btn">
                        <i class="fas fa-file-export"></i> Export as JSON
                    </button>
                    <button id="copyJsonBtn" class="save-btn">
                        <i class="fas fa-copy"></i> Copy JSON to Clipboard
                    </button>
                </div>

                <div class="firebase-options">
                    <h4>Firebase Storage</h4>
                    <button id="firebaseSaveBtn" class="firebase-btn" disabled>
                        <i class="fas fa-database"></i> Save to Firebase
                    </button>
                    <button id="firebaseLoadBtn" class="firebase-btn" disabled>
                        <i class="fas fa-download"></i> Load from Firebase
                    </button>
                </div>
            </div>
        </div>
        
        <footer>
            <p class="footer-text">Words Separator App &copy; 2025 | Analyze and translate text with ease</p>
            <p class="footer-text copyright">Copyright Omar Municipality, Sulu, Philippines</p>
        </footer>
    </div>

    <div class="notification" id="notification">
        File downloaded successfully!
    </div>

    <div class="modal" id="savedTranslationsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Saved Translations</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="translationsList">
                <!-- Saved translations will be listed here -->
            </div>
     <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCgAEuD8F41dH5nUeoVxMot4-rTp4olmr8",
        authDomain: "tausug-dictionary-online.firebaseapp.com",
        projectId: "tausug-dictionary-online",
        storageBucket: "tausug-dictionary-online.firebasestorage.app",
        messagingSenderId: "919499038754",
        appId: "1:919499038754:web:051037787db5a6123c2a7b",
        measurementId: "G-LBKT0624FT"
    };
    
    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    
    // Make db available globally for your existing functions
    window.firebaseDb = db;
</script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Firebase configuration
            const firebaseConfig = {
                apiKey: "",
                projectId: ""
            };
            
            let db = null;
            let analyzedWords = [];
            let uniqueWordsSet = new Set();
            let isFirebaseInitialized = false;
            
            // DOM Elements
            const processBtn = document.getElementById('processBtn');
            const resetBtn = document.getElementById('resetBtn');
            const totalBtn = document.getElementById('totalBtn');
            const inputText = document.getElementById('inputText');
            const wordsContainer = document.getElementById('wordsContainer');
            const saveJsonBtn = document.getElementById('saveJsonBtn');
            const copyJsonBtn = document.getElementById('copyJsonBtn');
            const firebaseSaveBtn = document.getElementById('firebaseSaveBtn');
            const firebaseLoadBtn = document.getElementById('firebaseLoadBtn');
            const notification = document.getElementById('notification');
            const languageSelect = document.getElementById('languageSelect');
            const totalDisplay = document.getElementById('totalDisplay');
            const uniqueWordsContainer = document.getElementById('uniqueWords');
            const firebaseApiKey = document.getElementById('firebaseApiKey');
            const firebaseProjectId = document.getElementById('firebaseProjectId');
            const initFirebaseBtn = document.getElementById('initFirebaseBtn');
            const firebaseProgress = document.getElementById('firebaseProgress');
            const savedTranslationsModal = document.getElementById('savedTranslationsModal');
            const translationsList = document.getElementById('translationsList');
            const closeModal = document.querySelector('.close-modal');
            
            // Load saved Firebase config from localStorage if available
            const savedConfig = localStorage.getItem('firebaseConfig');
            if (savedConfig) {
                try {
                    const config = JSON.parse(savedConfig);
                    firebaseApiKey.value = config.apiKey || '';
                    firebaseProjectId.value = config.projectId || '';
                } catch (e) {
                    console.error("Error loading saved Firebase config:", e);
                }
            }
            
            // Initialize Firebase
            initFirebaseBtn.addEventListener('click', function() {
                const apiKey = firebaseApiKey.value.trim();
                const projectId = firebaseProjectId.value.trim();
                
                if (!apiKey || !projectId) {
                    showNotification('Please enter both API Key and Project ID', true);
                    return;
                }
                
                // Update Firebase config
                firebaseConfig.apiKey = apiKey;
                firebaseConfig.projectId = projectId;
                
                // Save to localStorage
                localStorage.setItem('firebaseConfig', JSON.stringify({ apiKey, projectId }));
                
                // Show progress
                firebaseProgress.style.width = '30%';
                
                try {
                    // Initialize Firebase
                    firebase.initializeApp(firebaseConfig);
                    db = firebase.firestore();
                    
                    firebaseProgress.style.width = '60%';
                    
                    // Test connection
                    db.collection('test').doc('connection').set({
                        test: true,
                        timestamp: new Date()
                    }).then(() => {
                        firebaseProgress.style.width = '100%';
                        isFirebaseInitialized = true;
                        firebaseSaveBtn.disabled = false;
                        firebaseLoadBtn.disabled = false;
                        
                        setTimeout(() => {
                            firebaseProgress.style.width = '0%';
                        }, 1000);
                        
                        showNotification('Firebase connected successfully!');
                    }).catch(error => {
                        firebaseProgress.style.width = '0%';
                        showNotification('Firebase connection failed: ' + error.message, true);
                    });
                } catch (error) {
                    firebaseProgress.style.width = '0%';
                    showNotification('Firebase initialization error: ' + error.message, true);
                }
            });
            
            // Sample translations database
            const translations = {
                'the': { en: 'the', ts: 'in', ar: 'ال' },
                'quick': { en: 'quick', ts: 'maddas', ar: 'سريع' },
                'brown': { en: 'brown', ts: 'kulay kakah', ar: 'بني' },
                'fox': { en: 'fox', ts: 'urus', ar: 'ثعلب' },
                'jumps': { en: 'jumps', ts: 'lumuksu', ar: 'يقفز' },
                'over': { en: 'over', ts: 'hampang', ar: 'فوق' },
                'lazy': { en: 'lazy', ts: 'malas', ar: 'كسول' },
                'dog': { en: 'dog', ts: 'iru', ar: 'كلب' }
            };
            
            // Parts of speech database
            const partsOfSpeech = {
                'the': 'determiner',
                'quick': 'adjective',
                'brown': 'adjective',
                'fox': 'noun',
                'jumps': 'verb',
                'over': 'preposition',
                'lazy': 'adjective',
                'dog': 'noun'
            };
            
            // Process the sentence
            processBtn.addEventListener('click', function() {
                const sentence = inputText.value.trim();
                if (!sentence) {
                    showNotification('Please enter a sentence', true);
                    return;
                }
                
                // Clear previous results
                wordsContainer.innerHTML = '';
                analyzedWords = [];
                uniqueWordsSet.clear();
                updateTotalDisplay();
                
                // Split into words
                const words = sentence.split(/\s+/);
                const selectedLanguage = languageSelect.value;
                
                // Create word boxes
                words.forEach(word => {
                    const cleanWord = word.replace(/[.,!?;:"]/g, '').toLowerCase();
                    const pos = partsOfSpeech[cleanWord] || 'other';
                    
                    // Skip if we've already processed this word
                    if (uniqueWordsSet.has(cleanWord)) {
                        return;
                    }
                    
                    // Add to unique words set
                    uniqueWordsSet.add(cleanWord);
                    
                    // Get translation if available
                    let translation = '';
                    if (translations[cleanWord] && selectedLanguage !== 'custom') {
                        translation = translations[cleanWord][selectedLanguage] || '';
                    }
                    
                    // Store word data
                    analyzedWords.push({
                        original: word,
                        clean: cleanWord,
                        translation: translation,
                        pos: pos,
                        hasTranslation: !!translation
                    });
                    
                    // Create word box
                    const wordBox = document.createElement('div');
                    wordBox.className = 'word-box';
                    
                    const wordEl = document.createElement('div');
                    wordEl.className = 'word';
                    wordEl.textContent = word;
                    
                    const posEl = document.createElement('div');
                    posEl.className = 'pos';
                    posEl.textContent = pos;
                    
                    const translationInput = document.createElement('input');
                    translationInput.type = 'text';
                    translationInput.className = 'translation-input';
                    translationInput.placeholder = 'Enter translation...';
                    translationInput.value = translation;
                    
                    // Update the data model when translation changes
                    translationInput.addEventListener('input', function() {
                        const index = Array.from(wordsContainer.children).indexOf(wordBox);
                        if (index !== -1) {
                            analyzedWords[index].translation = this.value;
                            analyzedWords[index].hasTranslation = this.value.trim() !== '';
                        }
                    });
                    
                    wordBox.appendChild(wordEl);
                    wordBox.appendChild(posEl);
                    wordBox.appendChild(translationInput);
                    
                    wordsContainer.appendChild(wordBox);
                });
                
                updateTotalDisplay();
                showNotification('Sentence processed successfully!');
            });
            
            // Reset the app
            resetBtn.addEventListener('click', function() {
                inputText.value = '';
                wordsContainer.innerHTML = '';
                analyzedWords = [];
                uniqueWordsSet.clear();
                updateTotalDisplay();
                inputText.focus();
                showNotification('Application reset');
            });
            
            // Calculate and display total
            totalBtn.addEventListener('click', function() {
                updateTotalDisplay();
                showNotification('Total unique words calculated!');
            });
            
            // Update total display
            function updateTotalDisplay() {
                totalDisplay.textContent = `Total Unique Words: ${uniqueWordsSet.size}`;
                
                // Display unique words
                uniqueWordsContainer.innerHTML = '';
                uniqueWordsSet.forEach(word => {
                    const wordEl = document.createElement('span');
                    wordEl.className = 'unique-word';
                    wordEl.textContent = word;
                    uniqueWordsContainer.appendChild(wordEl);
                });
            }
            
            // Save as JSON
            saveJsonBtn.addEventListener('click', function() {
                if (analyzedWords.length === 0) {
                    showNotification('Please process a sentence first', true);
                    return;
                }
                
                // Filter out words without translations
                const wordsWithTranslations = analyzedWords.filter(word => word.hasTranslation);
                
                if (wordsWithTranslations.length === 0) {
                    showNotification('No words with translations to save!', true);
                    return;
                }
                
                // Prepare data for export
                const exportData = {
                    words: wordsWithTranslations,
                    language: languageSelect.options[languageSelect.selectedIndex].text,
                    originalSentence: inputText.value,
                    exportDate: new Date().toISOString(),
                    totalWords: wordsWithTranslations.length
                };
                
                const content = JSON.stringify(exportData, null, 2);
                downloadFile(content, 'word-translations.json', 'application/json');
                showNotification('File downloaded successfully!');
            });
            
            // Copy JSON to clipboard
            copyJsonBtn.addEventListener('click', function() {
                if (analyzedWords.length === 0) {
                    showNotification('Please process a sentence first', true);
                    return;
                }
                
                // Filter out words without translations
                const wordsWithTranslations = analyzedWords.filter(word => word.hasTranslation);
                
                if (wordsWithTranslations.length === 0) {
                    showNotification('No words with translations to copy!', true);
                    return;
                }
                
                // Prepare data for export
                const exportData = {
                    words: wordsWithTranslations,
                    language: languageSelect.options[languageSelect.selectedIndex].text,
                    originalSentence: inputText.value,
                    exportDate: new Date().toISOString(),
                    totalWords: wordsWithTranslations.length
                };
                
                const content = JSON.stringify(exportData, null, 2);
                
                // Copy to clipboard
                navigator.clipboard.writeText(content).then(() => {
                    showNotification('JSON copied to clipboard!');
                }).catch(err => {
                    showNotification('Failed to copy JSON: ' + err, true);
                });
            });
            
            // Save to Firebase
            firebaseSaveBtn.addEventListener('click', async function() {
                if (!isFirebaseInitialized) {
                    showNotification('Please initialize Firebase first', true);
                    return;
                }
                
                if (analyzedWords.length === 0) {
                    showNotification('Please process a sentence first', true);
                    return;
                }
                
                // Filter out words without translations
                const wordsWithTranslations = analyzedWords.filter(word => word.hasTranslation);
                
                if (wordsWithTranslations.length === 0) {
                    showNotification('No words with translations to save!', true);
                    return;
                }
                
                try {
                    // Show loading state
                    firebaseSaveBtn.classList.add('btn-loading');
                    
                    // Prepare data for saving
                    const saveData = {
                        words: wordsWithTranslations,
                        language: languageSelect.options[languageSelect.selectedIndex].text,
                        originalSentence: inputText.value,
                        savedAt: new Date().toISOString(),
                        totalWords: wordsWithTranslations.length
                    };
                    
                    // Save to Firestore
                    const docRef = await db.collection('translations').add(saveData);
                    
                    // Update UI
                    firebaseSaveBtn.classList.remove('btn-loading');
                    showNotification('Translations saved to Firebase successfully!');
                    
                } catch (error) {
                    console.error("Error saving to Firebase: ", error);
                    firebaseSaveBtn.classList.remove('btn-loading');
                    showNotification('Error saving to Firebase: ' + error.message, true);
                }
            });
            
            // Load from Firebase
            firebaseLoadBtn.addEventListener('click', async function() {
                if (!isFirebaseInitialized) {
                    showNotification('Please initialize Firebase first', true);
                    return;
                }
                
                try {
                    // Show loading state
                    firebaseLoadBtn.classList.add('btn-loading');
                    
                    // Get saved translations
                    const snapshot = await db.collection('translations')
                        .orderBy('savedAt', 'desc')
                        .limit(10)
                        .get();
                    
                    if (snapshot.empty) {
                        firebaseLoadBtn.classList.remove('btn-loading');
                        showNotification('No saved translations found', true);
                        return;
                    }
                    
                    // Clear previous list
                    translationsList.innerHTML = '';
                    
                    // Add each translation to the list
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        const item = document.createElement('div');
                        item.className = 'translation-item';
                        
                        item.innerHTML = `
                            <h4>${data.originalSentence}</h4>
                            <p><strong>Language:</strong> ${data.language}</p>
                            <p><strong>Date:</strong> ${new Date(data.savedAt).toLocaleString()}</p>
                            <button class="load-btn" data-id="${doc.id}">Load This Translation</button>
                        `;
                        
                        translationsList.appendChild(item);
                    });
                    
                    // Add event listeners to load buttons
                    document.querySelectorAll('.load-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const docId = this.getAttribute('data-id');
                            loadTranslation(docId);
                        });
                    });
                    
                    // Show modal
                    savedTranslationsModal.style.display = 'flex';
                    firebaseLoadBtn.classList.remove('btn-loading');
                    
                } catch (error) {
                    console.error("Error loading from Firebase: ", error);
                    firebaseLoadBtn.classList.remove('btn-loading');
                    showNotification('Error loading from Firebase: ' + error.message, true);
                }
            });
            
            // Load a specific translation
            async function loadTranslation(docId) {
                try {
                    const doc = await db.collection('translations').doc(docId).get();
                    
                    if (!doc.exists) {
                        showNotification('Translation not found', true);
                        return;
                    }
                    
                    const data = doc.data();
                    
                    // Set the input text
                    inputText.value = data.originalSentence;
                    
                    // Set the language if it exists in our select
                    const options = Array.from(languageSelect.options);
                    const option = options.find(opt => opt.text === data.language);
                    if (option) {
                        languageSelect.value = option.value;
                    }
                    
                    // Process the sentence
                    processBtn.click();
                    
                    // Close modal
                    savedTranslationsModal.style.display = 'none';
                    
                    showNotification('Translation loaded successfully!');
                    
                } catch (error) {
                    console.error("Error loading translation: ", error);
                    showNotification('Error loading translation: ' + error.message, true);
                }
            }
            
            // Close modal
            closeModal.addEventListener('click', function() {
                savedTranslationsModal.style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === savedTranslationsModal) {
                    savedTranslationsModal.style.display = 'none';
                }
            });
            
            // Helper function to download a file
            function downloadFile(content, fileName, contentType) {
                const blob = new Blob([content], { type: contentType });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                a.click();
                URL.revokeObjectURL(url);
            }
            
            // Show notification
            function showNotification(message, isError = false) {
                notification.textContent = message;
                notification.className = isError ? 'notification error show' : 'notification show';
            }
            
            // Process the example sentence on load
            setTimeout(() => processBtn.click(), 500);
        });
    </script>
            <!-- Add these right before your existing script tags -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCgAEuD8F41dH5nUeoVxMot4-rTp4olmr8",
        authDomain: "tausug-dictionary-online.firebaseapp.com",
        projectId: "tausug-dictionary-online",
        storageBucket: "tausug-dictionary-online.firebasestorage.app",
        messagingSenderId: "919499038754",
        appId: "1:919499038754:web:051037787db5a6123c2a7b",
        measurementId: "G-LBKT0624FT"
    };
    
    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    
    // Make db available globally for your existing functions
    window.firebaseDb = db;
</script>
</body>
</html>


